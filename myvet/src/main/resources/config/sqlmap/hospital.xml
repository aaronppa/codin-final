<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.codin.repository.mapper.HosMapper">

	<resultMap type="Hospital" id="hospitalMap">
		<result column="hos_code" property="hosCode"/>
		<result column="title" property="title"/>
		<result column="roadAddress" property="roadAddress"/>
		<result column="address" property="address"/>
		<result column="mapx" property="mapx"/>
		<result column="mapy" property="mapy"/>
		<result column="hos_search_cnt" property="hosSearchCnt"/>
		<result column="telephone" property="telephone"/>
		<result column="hos_register" property="hosRegister"/>
		<result column="lunch_start" property="lunchStart"/>
		<result column="lunch_end" property="lunchEnd"/>
		<result column="hos_homepage" property="hosHomepage"/>
		<result column="hos_comment" property="hosComment"/>		
	</resultMap>
	
	<resultMap type="HosFacility" id="facilityMap">
		<result column="facility_no" property="facilityNo"/>
		<result column="hos_code" property="hosCode"/>
		<result column="facility_code" property="facilityCode"/>
		<result column="facility_bookable" property="facilityBookable"/>
		<result column="staff_no" property="staffNo"/>
		<result column="max_booking" property="maxBooking"/>
	</resultMap>
	
	<resultMap type="HosFacilitylist" id="facilitylistMap">
		<result column="facility_code" property="facilityCode"/>		
		<result column="facility_name" property="facilityName"/>		
	</resultMap>
	
	<resultMap type="HosHours" id="hoursMap">
		<result column="hours_no" property="hoursNo"/>		
		<result column="hos_code" property="hosCode"/>		
		<result column="open_day" property="openDay"/>		
		<result column="open_time" property="openTime"/>		
		<result column="close_time" property="closeTime"/>		
		<result column="dayoff" property="dayoff"/>		
	</resultMap>

	<insert id="insertHospital" parameterType="Hospital">
		insert into hos_basic
		(title, roadAddress, address, mapx, mapy, telephone)
		values
		(#{title}, #{roadAddress}, #{address}, #{mapx}, #{mapy}, #{telephone})
	</insert>
	
	<select id="selectFacility" resultMap="facilitylistMap">
		select *
		from hos_facilitylist
		order by facility_code
	</select>
	
	<select id="searchHos" parameterType="string" resultMap="hospitalMap">
		select *
		from hos_basic
		where title like CONCAT('%',#{keyWord},'%')
	</select>
	
	<insert id="insertFacility" parameterType="HosFacility">
		insert into hos_facility
		(hos_code, facility_code)
		values
		(#{hosCode}, #{facilityCode})
	</insert>
	
	<insert id="insertDayoff" parameterType="HosHours">
		insert into hos_hours
		(hos_code, open_day, dayoff)
		values
		(#{hosCode},#{openDay},'Y')
	</insert>
	
	<update id="registerUpdate" parameterType="Hospital">
		update hos_basic
		set hos_register = 'Y',
			hos_comment = #{hosComment}
		where hos_code = #{hosCode}
	</update>
	
</mapper>
